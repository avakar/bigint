#include "../src/bigint/bigint.h"
#include "../src/cint/strtoc.h"
#include "../src/cint/operators.h"
#include "../src/generic_traits.h"

#include <stdint.h>
#include "catch.hpp"

#include <cassert>

using B = avakar::_bigint::bigint<avakar::_bigint::generic_traits<uint16_t, uint32_t>>;

template <char... cn>
avakar::_cint::parse_literal_t<uint16_t, cn...> operator""_b() { return {}; }

TEST_CASE("bigint: default constructor")
{
	B b;
	REQUIRE(b == 0_b);
}

TEST_CASE("bigint: equality")
{
	REQUIRE(B(0_b) == 0_b);
	REQUIRE_FALSE(B(0_b) != 0_b);

	REQUIRE(B(1_b) != 0_b);
	REQUIRE_FALSE(B(1_b) == 0_b);

	REQUIRE(B(1_b) == 1_b);
	REQUIRE_FALSE(B(1_b) != 1_b);

	REQUIRE(B(0_b) != 9999999999999999999999_b);
}

TEST_CASE("bigint: int constructor")
{
	REQUIRE(B(0) == 0_b);
	REQUIRE(B(1) == 1_b);
	REQUIRE(B(2) == 2_b);
	REQUIRE(B(0x7fff) == 0x7fff_b);
	REQUIRE(B(0x8000) == 0x8000_b);
	REQUIRE(B(0xffff) == 0xffff_b);
	REQUIRE(B(0x10000) == 0x10000_b);
	REQUIRE(B(0x10001) == 0x10001_b);
	REQUIRE(B(0x10002) == 0x10002_b);
	REQUIRE(B(0x7fffffff) == 0x7fffffff_b);
	REQUIRE(B(0x80000000) == 0x80000000_b);
	REQUIRE(B(0xffffffff) == 0xffffffff_b);
}

TEST_CASE("bigint: addition")
{
	REQUIRE(B(0_b) + B(0_b) == 0_b);
	REQUIRE(B(0_b) + B(1_b) == 1_b);
	REQUIRE(B(0_b) + B(-1_b) == -1_b);
	REQUIRE(B(0_b) + B(-2_b) == -2_b);
	REQUIRE(B(1_b) + B(1_b) == 2_b);
	REQUIRE(B(1_b) + B(0_b) == 1_b);
	REQUIRE(B(1_b) + B(-1_b) == 0_b);
	REQUIRE(B(1_b) + B(-2_b) == -1_b);
	REQUIRE(B(-1_b) + B(1_b) == 0_b);
	REQUIRE(B(-1_b) + B(0_b) == -1_b);
	REQUIRE(B(-1_b) + B(-1_b) == -2_b);
	REQUIRE(B(-1_b) + B(-2_b) == -3_b);
	REQUIRE(B(-2_b) + B(1_b) == -1_b);
	REQUIRE(B(-2_b) + B(0_b) == -2_b);
	REQUIRE(B(-2_b) + B(-1_b) == -3_b);
	REQUIRE(B(-2_b) + B(-2_b) == -4_b);

	REQUIRE(B(0x7fff_b) + B(0_b) == 0x7fff_b);
	REQUIRE(B(0x7fff_b) + B(1_b) == 0x8000_b);
	REQUIRE(B(0x7fff_b) + B(2_b) == 0x8001_b);
	REQUIRE(B(0_b) + B(0x7fff_b) == 0x7fff_b);
	REQUIRE(B(1_b) + B(0x7fff_b) == 0x8000_b);
	REQUIRE(B(2_b) + B(0x7fff_b) == 0x8001_b);

	REQUIRE(B(0x8000_b) + B(-2_b) == 0x7ffe_b);
	REQUIRE(B(0x8000_b) + B(-1_b) == 0x7fff_b);
	REQUIRE(B(0x8000_b) + B(0_b) == 0x8000_b);
	REQUIRE(B(0x8000_b) + B(1_b) == 0x8001_b);
	REQUIRE(B(0x8000_b) + B(2_b) == 0x8002_b);
	REQUIRE(B(0x8001_b) + B(-2_b) == 0x7fff_b);
	REQUIRE(B(0x8001_b) + B(-1_b) == 0x8000_b);
	REQUIRE(B(0x8001_b) + B(0_b) == 0x8001_b);
	REQUIRE(B(0x8001_b) + B(1_b) == 0x8002_b);

	REQUIRE(B(-2_b) + B(0x8000_b) == 0x7ffe_b);
	REQUIRE(B(-1_b) + B(0x8000_b) == 0x7fff_b);
	REQUIRE(B(0_b) + B(0x8000_b) == 0x8000_b);
	REQUIRE(B(1_b) + B(0x8000_b) == 0x8001_b);
	REQUIRE(B(2_b) + B(0x8000_b) == 0x8002_b);
	REQUIRE(B(-2_b) + B(0x8001_b) == 0x7fff_b);
	REQUIRE(B(-1_b) + B(0x8001_b) == 0x8000_b);
	REQUIRE(B(0_b) + B(0x8001_b) == 0x8001_b);
	REQUIRE(B(1_b) + B(0x8001_b) == 0x8002_b);
}

TEST_CASE("bigint: unary plus")
{
	REQUIRE(+B(0x10001_b) == B(0x10001_b));
	REQUIRE(+B(0x10000_b) == B(0x10000_b));
	REQUIRE(+B(0xffff_b) == B(0xffff_b));
	REQUIRE(+B(0x8001_b) == B(0x8001_b));
	REQUIRE(+B(0x8000_b) == B(0x8000_b));
	REQUIRE(+B(0x7fff_b) == B(0x7fff_b));
	REQUIRE(+B(1_b) == B(1_b));
	REQUIRE(+B(0_b) == B(0_b));
	REQUIRE(+B(-1_b) == B(-1_b));
	REQUIRE(+B(-0x7fff_b) == B(-0x7fff_b));
	REQUIRE(+B(-0x8000_b) == B(-0x8000_b));
	REQUIRE(+B(-0x8001_b) == B(-0x8001_b));
	REQUIRE(+B(-0xffff_b) == B(-0xffff_b));
	REQUIRE(+B(-0x10000_b) == B(-0x10000_b));
	REQUIRE(+B(-0x10001_b) == B(-0x10001_b));
}

TEST_CASE("bigint: unary minus")
{
	REQUIRE(-B(0x10001_b) == B(-0x10001_b));
	REQUIRE(-B(0x10000_b) == B(-0x10000_b));
	REQUIRE(-B(0xffff_b) == B(-0xffff_b));
	REQUIRE(-B(0x8001_b) == B(-0x8001_b));
	REQUIRE(-B(0x8000_b) == B(-0x8000_b));
	REQUIRE(-B(0x7fff_b) == B(-0x7fff_b));
	REQUIRE(-B(1_b) == B(-1_b));
	REQUIRE(-B(0_b) == B(0_b));
	REQUIRE(-B(-1_b) == B(1_b));
	REQUIRE(-B(-0x7fff_b) == B(0x7fff_b));
	REQUIRE(-B(-0x8000_b) == B(0x8000_b));
	REQUIRE(-B(-0x8001_b) == B(0x8001_b));
	REQUIRE(-B(-0xffff_b) == B(0xffff_b));
	REQUIRE(-B(-0x10000_b) == B(0x10000_b));
	REQUIRE(-B(-0x10001_b) == B(0x10001_b));
}

TEST_CASE("bigint: subtraction")
{
	REQUIRE(B(0_b) - B(0_b) == 0_b);
	REQUIRE(B(0_b) - B(1_b) == -1_b);
	REQUIRE(B(0_b) - B(-1_b) == 1_b);
	REQUIRE(B(0_b) - B(-2_b) == 2_b);
	REQUIRE(B(1_b) - B(1_b) == 0_b);
	REQUIRE(B(1_b) - B(0_b) == 1_b);
	REQUIRE(B(1_b) - B(-1_b) == 2_b);
	REQUIRE(B(1_b) - B(-2_b) == 3_b);
	REQUIRE(B(-1_b) - B(1_b) == -2_b);
	REQUIRE(B(-1_b) - B(0_b) == -1_b);
	REQUIRE(B(-1_b) - B(-1_b) == 0_b);
	REQUIRE(B(-1_b) - B(-2_b) == 1_b);
	REQUIRE(B(-2_b) - B(1_b) == -3_b);
	REQUIRE(B(-2_b) - B(0_b) == -2_b);
	REQUIRE(B(-2_b) - B(-1_b) == -1_b);
	REQUIRE(B(-2_b) - B(-2_b) == 0_b);

	REQUIRE(B(0x7fff_b) - B(0_b) == 0x7fff_b);
	REQUIRE(B(0x7fff_b) - B(1_b) == 0x7ffe_b);
	REQUIRE(B(0x7fff_b) - B(2_b) == 0x7ffd_b);
	REQUIRE(B(0_b) - B(0x7fff_b) == -0x7fff_b);
	REQUIRE(B(1_b) - B(0x7fff_b) == -0x7ffe_b);
	REQUIRE(B(2_b) - B(0x7fff_b) == -0x7ffd_b);

	REQUIRE(B(0x8000_b) - B(-2_b) == 0x8002_b);
	REQUIRE(B(0x8000_b) - B(-1_b) == 0x8001_b);
	REQUIRE(B(0x8000_b) - B(0_b) == 0x8000_b);
	REQUIRE(B(0x8000_b) - B(1_b) == 0x7fff_b);
	REQUIRE(B(0x8000_b) - B(2_b) == 0x7ffe_b);
	REQUIRE(B(0x8001_b) - B(-2_b) == 0x8003_b);
	REQUIRE(B(0x8001_b) - B(-1_b) == 0x8002_b);
	REQUIRE(B(0x8001_b) - B(0_b) == 0x8001_b);
	REQUIRE(B(0x8001_b) - B(1_b) == 0x8000_b);

	REQUIRE(B(-2_b) - B(0x8000_b) == -0x8002_b);
	REQUIRE(B(-1_b) - B(0x8000_b) == -0x8001_b);
	REQUIRE(B(0_b) - B(0x8000_b) == -0x8000_b);
	REQUIRE(B(1_b) - B(0x8000_b) == -0x7fff_b);
	REQUIRE(B(2_b) - B(0x8000_b) == -0x7ffe_b);
	REQUIRE(B(-2_b) - B(0x8001_b) == -0x8003_b);
	REQUIRE(B(-1_b) - B(0x8001_b) == -0x8002_b);
	REQUIRE(B(0_b) - B(0x8001_b) == -0x8001_b);
	REQUIRE(B(1_b) - B(0x8001_b) == -0x8000_b);
}

TEST_CASE("bigint: comparison")
{
	REQUIRE_FALSE(B(0_b) < B(0_b));
	REQUIRE_FALSE(B(0_b) > B(0_b));
	REQUIRE(B(0_b) <= B(0_b));
	REQUIRE(B(0_b) >= B(0_b));

	REQUIRE(B(0_b) < B(1_b));
	REQUIRE_FALSE(B(0_b) > B(1_b));
	REQUIRE(B(0_b) <= B(1_b));
	REQUIRE_FALSE(B(0_b) >= B(1_b));

	REQUIRE_FALSE(B(0_b) < B(-1_b));
	REQUIRE(B(0_b) > B(-1_b));
	REQUIRE_FALSE(B(0_b) <= B(-1_b));
	REQUIRE(B(0_b) >= B(-1_b));
}

TEST_CASE("bigint: bitwise")
{
	REQUIRE((B(0_b) & B(0_b)) == B(0_b));
	REQUIRE((B(1_b) & B(0_b)) == B(0_b));
	REQUIRE((B(1_b) & B(1_b)) == B(1_b));
	REQUIRE((B(-1_b) & B(1_b)) == B(1_b));
	REQUIRE((B(-1_b) & B(-1_b)) == B(-1_b));
	REQUIRE((B(-1_b) & B(0xffff_b)) == B(0xffff_b));
	REQUIRE((B(0xffff_b) & B(-1_b)) == B(0xffff_b));
	REQUIRE((B(0xffff_b) & B(0xffff_b)) == B(0xffff_b));
	REQUIRE((B(0x5555aaaa_b) & B(-0x5555aaab_b)) == B(0_b));

	REQUIRE((B(0_b) | B(0_b)) == B(0_b));
	REQUIRE((B(1_b) | B(0_b)) == B(1_b));
	REQUIRE((B(1_b) | B(1_b)) == B(1_b));
	REQUIRE((B(-1_b) | B(1_b)) == B(-1_b));
	REQUIRE((B(-1_b) | B(0xffff_b)) == B(-1_b));
	REQUIRE((B(0xffff_b) | B(-1_b)) == B(-1_b));
	REQUIRE((B(0xffff_b) | B(0xffff_b)) == B(0xffff_b));
	REQUIRE((B(0x5555aaaa_b) | B(-0x5555aaab_b)) == B(-1_b));

	REQUIRE((B(0_b) ^ B(0_b)) == B(0_b));
	REQUIRE((B(1_b) ^ B(0_b)) == B(1_b));
	REQUIRE((B(1_b) ^ B(1_b)) == B(0_b));
	REQUIRE((B(-1_b) ^ B(1_b)) == B(-2_b));
	REQUIRE((B(-1_b) ^ B(0xffff_b)) == B(-0x10000_b));
	REQUIRE((B(0xffff_b) ^ B(0xffff_b)) == B(0_b));
	REQUIRE((B(0x5555aaaa_b) ^ B(-0x5555aaab_b)) == B(-1_b));
	REQUIRE((B(0x5555aaaa_b) ^ B(0xaaaa5555_b)) == B(0xffffffff_b));
}

TEST_CASE("bigint: complement")
{
	REQUIRE(~B(0_b) == B(-1_b));
	REQUIRE(~B(1_b) == B(-2_b));
	REQUIRE(~B(0x8000_b) == B(-0x8001_b));
	REQUIRE(~B(-1_b) == B(0_b));
}

TEST_CASE("bigint: multiply")
{
	REQUIRE(B(0_b) * B(-1_b) == B(0_b));
	REQUIRE(B(0_b) * B(0_b) == B(0_b));
	REQUIRE(B(0_b) * B(1_b) == B(0_b));
	REQUIRE(B(1_b) * B(-1_b) == B(-1_b));
	REQUIRE(B(1_b) * B(0_b) == B(0_b));
	REQUIRE(B(1_b) * B(1_b) == B(1_b));
	REQUIRE(B(-1_b) * B(-1_b) == B(1_b));
	REQUIRE(B(-1_b) * B(0_b) == B(0_b));
	REQUIRE(B(-1_b) * B(1_b) == B(-1_b));

	REQUIRE(B(-0x100000001_b) * B(-0x100000001_b) == B(0x10000000200000001_b));
	REQUIRE(B(-0x100000001_b) * B(-0x100000000_b) == B(0x10000000100000000_b));
	REQUIRE(B(-0x100000001_b) * B(-0xffffffff_b) == B(0xffffffffffffffff_b));
	REQUIRE(B(-0x100000001_b) * B(-0x80000001_b) == B(0x8000000180000001_b));
	REQUIRE(B(-0x100000001_b) * B(-0x80000000_b) == B(0x8000000080000000_b));
	REQUIRE(B(-0x100000001_b) * B(-0x7fffffff_b) == B(0x7fffffff7fffffff_b));
	REQUIRE(B(-0x100000001_b) * B(-0x10001_b) == B(0x1000100010001_b));
	REQUIRE(B(-0x100000001_b) * B(-0x10000_b) == B(0x1000000010000_b));
	REQUIRE(B(-0x100000001_b) * B(-0xffff_b) == B(0xffff0000ffff_b));
	REQUIRE(B(-0x100000001_b) * B(-0x8001_b) == B(0x800100008001_b));
	REQUIRE(B(-0x100000001_b) * B(-0x8000_b) == B(0x800000008000_b));
	REQUIRE(B(-0x100000001_b) * B(-0x7fff_b) == B(0x7fff00007fff_b));
	REQUIRE(B(-0x100000001_b) * B(0x7fff_b) == B(-0x7fff00007fff_b));
	REQUIRE(B(-0x100000001_b) * B(0x8000_b) == B(-0x800000008000_b));
	REQUIRE(B(-0x100000001_b) * B(0x8001_b) == B(-0x800100008001_b));
	REQUIRE(B(-0x100000001_b) * B(0xffff_b) == B(-0xffff0000ffff_b));
	REQUIRE(B(-0x100000001_b) * B(0x10000_b) == B(-0x1000000010000_b));
	REQUIRE(B(-0x100000001_b) * B(0x10001_b) == B(-0x1000100010001_b));
	REQUIRE(B(-0x100000001_b) * B(0x7fffffff_b) == B(-0x7fffffff7fffffff_b));
	REQUIRE(B(-0x100000001_b) * B(0x80000000_b) == B(-0x8000000080000000_b));
	REQUIRE(B(-0x100000001_b) * B(0x80000001_b) == B(-0x8000000180000001_b));
	REQUIRE(B(-0x100000001_b) * B(0xffffffff_b) == B(-0xffffffffffffffff_b));
	REQUIRE(B(-0x100000001_b) * B(0x100000000_b) == B(-0x10000000100000000_b));
	REQUIRE(B(-0x100000001_b) * B(0x100000001_b) == B(-0x10000000200000001_b));
	REQUIRE(B(-0x100000000_b) * B(-0x100000001_b) == B(0x10000000100000000_b));
	REQUIRE(B(-0x100000000_b) * B(-0x100000000_b) == B(0x10000000000000000_b));
	REQUIRE(B(-0x100000000_b) * B(-0xffffffff_b) == B(0xffffffff00000000_b));
	REQUIRE(B(-0x100000000_b) * B(-0x80000001_b) == B(0x8000000100000000_b));
	REQUIRE(B(-0x100000000_b) * B(-0x80000000_b) == B(0x8000000000000000_b));
	REQUIRE(B(-0x100000000_b) * B(-0x7fffffff_b) == B(0x7fffffff00000000_b));
	REQUIRE(B(-0x100000000_b) * B(-0x10001_b) == B(0x1000100000000_b));
	REQUIRE(B(-0x100000000_b) * B(-0x10000_b) == B(0x1000000000000_b));
	REQUIRE(B(-0x100000000_b) * B(-0xffff_b) == B(0xffff00000000_b));
	REQUIRE(B(-0x100000000_b) * B(-0x8001_b) == B(0x800100000000_b));
	REQUIRE(B(-0x100000000_b) * B(-0x8000_b) == B(0x800000000000_b));
	REQUIRE(B(-0x100000000_b) * B(-0x7fff_b) == B(0x7fff00000000_b));
	REQUIRE(B(-0x100000000_b) * B(0x7fff_b) == B(-0x7fff00000000_b));
	REQUIRE(B(-0x100000000_b) * B(0x8000_b) == B(-0x800000000000_b));
	REQUIRE(B(-0x100000000_b) * B(0x8001_b) == B(-0x800100000000_b));
	REQUIRE(B(-0x100000000_b) * B(0xffff_b) == B(-0xffff00000000_b));
	REQUIRE(B(-0x100000000_b) * B(0x10000_b) == B(-0x1000000000000_b));
	REQUIRE(B(-0x100000000_b) * B(0x10001_b) == B(-0x1000100000000_b));
	REQUIRE(B(-0x100000000_b) * B(0x7fffffff_b) == B(-0x7fffffff00000000_b));
	REQUIRE(B(-0x100000000_b) * B(0x80000000_b) == B(-0x8000000000000000_b));
	REQUIRE(B(-0x100000000_b) * B(0x80000001_b) == B(-0x8000000100000000_b));
	REQUIRE(B(-0x100000000_b) * B(0xffffffff_b) == B(-0xffffffff00000000_b));
	REQUIRE(B(-0x100000000_b) * B(0x100000000_b) == B(-0x10000000000000000_b));
	REQUIRE(B(-0x100000000_b) * B(0x100000001_b) == B(-0x10000000100000000_b));
	REQUIRE(B(-0xffffffff_b) * B(-0x100000001_b) == B(0xffffffffffffffff_b));
	REQUIRE(B(-0xffffffff_b) * B(-0x100000000_b) == B(0xffffffff00000000_b));
	REQUIRE(B(-0xffffffff_b) * B(-0xffffffff_b) == B(0xfffffffe00000001_b));
	REQUIRE(B(-0xffffffff_b) * B(-0x80000001_b) == B(0x800000007fffffff_b));
	REQUIRE(B(-0xffffffff_b) * B(-0x80000000_b) == B(0x7fffffff80000000_b));
	REQUIRE(B(-0xffffffff_b) * B(-0x7fffffff_b) == B(0x7ffffffe80000001_b));
	REQUIRE(B(-0xffffffff_b) * B(-0x10001_b) == B(0x10000fffeffff_b));
	REQUIRE(B(-0xffffffff_b) * B(-0x10000_b) == B(0xffffffff0000_b));
	REQUIRE(B(-0xffffffff_b) * B(-0xffff_b) == B(0xfffeffff0001_b));
	REQUIRE(B(-0xffffffff_b) * B(-0x8001_b) == B(0x8000ffff7fff_b));
	REQUIRE(B(-0xffffffff_b) * B(-0x8000_b) == B(0x7fffffff8000_b));
	REQUIRE(B(-0xffffffff_b) * B(-0x7fff_b) == B(0x7ffeffff8001_b));
	REQUIRE(B(-0xffffffff_b) * B(0x7fff_b) == B(-0x7ffeffff8001_b));
	REQUIRE(B(-0xffffffff_b) * B(0x8000_b) == B(-0x7fffffff8000_b));
	REQUIRE(B(-0xffffffff_b) * B(0x8001_b) == B(-0x8000ffff7fff_b));
	REQUIRE(B(-0xffffffff_b) * B(0xffff_b) == B(-0xfffeffff0001_b));
	REQUIRE(B(-0xffffffff_b) * B(0x10000_b) == B(-0xffffffff0000_b));
	REQUIRE(B(-0xffffffff_b) * B(0x10001_b) == B(-0x10000fffeffff_b));
	REQUIRE(B(-0xffffffff_b) * B(0x7fffffff_b) == B(-0x7ffffffe80000001_b));
	REQUIRE(B(-0xffffffff_b) * B(0x80000000_b) == B(-0x7fffffff80000000_b));
	REQUIRE(B(-0xffffffff_b) * B(0x80000001_b) == B(-0x800000007fffffff_b));
	REQUIRE(B(-0xffffffff_b) * B(0xffffffff_b) == B(-0xfffffffe00000001_b));
	REQUIRE(B(-0xffffffff_b) * B(0x100000000_b) == B(-0xffffffff00000000_b));
	REQUIRE(B(-0xffffffff_b) * B(0x100000001_b) == B(-0xffffffffffffffff_b));
	REQUIRE(B(-0x80000001_b) * B(-0x100000001_b) == B(0x8000000180000001_b));
	REQUIRE(B(-0x80000001_b) * B(-0x100000000_b) == B(0x8000000100000000_b));
	REQUIRE(B(-0x80000001_b) * B(-0xffffffff_b) == B(0x800000007fffffff_b));
	REQUIRE(B(-0x80000001_b) * B(-0x80000001_b) == B(0x4000000100000001_b));
	REQUIRE(B(-0x80000001_b) * B(-0x80000000_b) == B(0x4000000080000000_b));
	REQUIRE(B(-0x80000001_b) * B(-0x7fffffff_b) == B(0x3fffffffffffffff_b));
	REQUIRE(B(-0x80000001_b) * B(-0x10001_b) == B(0x800080010001_b));
	REQUIRE(B(-0x80000001_b) * B(-0x10000_b) == B(0x800000010000_b));
	REQUIRE(B(-0x80000001_b) * B(-0xffff_b) == B(0x7fff8000ffff_b));
	REQUIRE(B(-0x80000001_b) * B(-0x8001_b) == B(0x400080008001_b));
	REQUIRE(B(-0x80000001_b) * B(-0x8000_b) == B(0x400000008000_b));
	REQUIRE(B(-0x80000001_b) * B(-0x7fff_b) == B(0x3fff80007fff_b));
	REQUIRE(B(-0x80000001_b) * B(0x7fff_b) == B(-0x3fff80007fff_b));
	REQUIRE(B(-0x80000001_b) * B(0x8000_b) == B(-0x400000008000_b));
	REQUIRE(B(-0x80000001_b) * B(0x8001_b) == B(-0x400080008001_b));
	REQUIRE(B(-0x80000001_b) * B(0xffff_b) == B(-0x7fff8000ffff_b));
	REQUIRE(B(-0x80000001_b) * B(0x10000_b) == B(-0x800000010000_b));
	REQUIRE(B(-0x80000001_b) * B(0x10001_b) == B(-0x800080010001_b));
	REQUIRE(B(-0x80000001_b) * B(0x7fffffff_b) == B(-0x3fffffffffffffff_b));
	REQUIRE(B(-0x80000001_b) * B(0x80000000_b) == B(-0x4000000080000000_b));
	REQUIRE(B(-0x80000001_b) * B(0x80000001_b) == B(-0x4000000100000001_b));
	REQUIRE(B(-0x80000001_b) * B(0xffffffff_b) == B(-0x800000007fffffff_b));
	REQUIRE(B(-0x80000001_b) * B(0x100000000_b) == B(-0x8000000100000000_b));
	REQUIRE(B(-0x80000001_b) * B(0x100000001_b) == B(-0x8000000180000001_b));
	REQUIRE(B(-0x80000000_b) * B(-0x100000001_b) == B(0x8000000080000000_b));
	REQUIRE(B(-0x80000000_b) * B(-0x100000000_b) == B(0x8000000000000000_b));
	REQUIRE(B(-0x80000000_b) * B(-0xffffffff_b) == B(0x7fffffff80000000_b));
	REQUIRE(B(-0x80000000_b) * B(-0x80000001_b) == B(0x4000000080000000_b));
	REQUIRE(B(-0x80000000_b) * B(-0x80000000_b) == B(0x4000000000000000_b));
	REQUIRE(B(-0x80000000_b) * B(-0x7fffffff_b) == B(0x3fffffff80000000_b));
	REQUIRE(B(-0x80000000_b) * B(-0x10001_b) == B(0x800080000000_b));
	REQUIRE(B(-0x80000000_b) * B(-0x10000_b) == B(0x800000000000_b));
	REQUIRE(B(-0x80000000_b) * B(-0xffff_b) == B(0x7fff80000000_b));
	REQUIRE(B(-0x80000000_b) * B(-0x8001_b) == B(0x400080000000_b));
	REQUIRE(B(-0x80000000_b) * B(-0x8000_b) == B(0x400000000000_b));
	REQUIRE(B(-0x80000000_b) * B(-0x7fff_b) == B(0x3fff80000000_b));
	REQUIRE(B(-0x80000000_b) * B(0x7fff_b) == B(-0x3fff80000000_b));
	REQUIRE(B(-0x80000000_b) * B(0x8000_b) == B(-0x400000000000_b));
	REQUIRE(B(-0x80000000_b) * B(0x8001_b) == B(-0x400080000000_b));
	REQUIRE(B(-0x80000000_b) * B(0xffff_b) == B(-0x7fff80000000_b));
	REQUIRE(B(-0x80000000_b) * B(0x10000_b) == B(-0x800000000000_b));
	REQUIRE(B(-0x80000000_b) * B(0x10001_b) == B(-0x800080000000_b));
	REQUIRE(B(-0x80000000_b) * B(0x7fffffff_b) == B(-0x3fffffff80000000_b));
	REQUIRE(B(-0x80000000_b) * B(0x80000000_b) == B(-0x4000000000000000_b));
	REQUIRE(B(-0x80000000_b) * B(0x80000001_b) == B(-0x4000000080000000_b));
	REQUIRE(B(-0x80000000_b) * B(0xffffffff_b) == B(-0x7fffffff80000000_b));
	REQUIRE(B(-0x80000000_b) * B(0x100000000_b) == B(-0x8000000000000000_b));
	REQUIRE(B(-0x80000000_b) * B(0x100000001_b) == B(-0x8000000080000000_b));
	REQUIRE(B(-0x7fffffff_b) * B(-0x100000001_b) == B(0x7fffffff7fffffff_b));
	REQUIRE(B(-0x7fffffff_b) * B(-0x100000000_b) == B(0x7fffffff00000000_b));
	REQUIRE(B(-0x7fffffff_b) * B(-0xffffffff_b) == B(0x7ffffffe80000001_b));
	REQUIRE(B(-0x7fffffff_b) * B(-0x80000001_b) == B(0x3fffffffffffffff_b));
	REQUIRE(B(-0x7fffffff_b) * B(-0x80000000_b) == B(0x3fffffff80000000_b));
	REQUIRE(B(-0x7fffffff_b) * B(-0x7fffffff_b) == B(0x3fffffff00000001_b));
	REQUIRE(B(-0x7fffffff_b) * B(-0x10001_b) == B(0x80007ffeffff_b));
	REQUIRE(B(-0x7fffffff_b) * B(-0x10000_b) == B(0x7fffffff0000_b));
	REQUIRE(B(-0x7fffffff_b) * B(-0xffff_b) == B(0x7fff7fff0001_b));
	REQUIRE(B(-0x7fffffff_b) * B(-0x8001_b) == B(0x40007fff7fff_b));
	REQUIRE(B(-0x7fffffff_b) * B(-0x8000_b) == B(0x3fffffff8000_b));
	REQUIRE(B(-0x7fffffff_b) * B(-0x7fff_b) == B(0x3fff7fff8001_b));
	REQUIRE(B(-0x7fffffff_b) * B(0x7fff_b) == B(-0x3fff7fff8001_b));
	REQUIRE(B(-0x7fffffff_b) * B(0x8000_b) == B(-0x3fffffff8000_b));
	REQUIRE(B(-0x7fffffff_b) * B(0x8001_b) == B(-0x40007fff7fff_b));
	REQUIRE(B(-0x7fffffff_b) * B(0xffff_b) == B(-0x7fff7fff0001_b));
	REQUIRE(B(-0x7fffffff_b) * B(0x10000_b) == B(-0x7fffffff0000_b));
	REQUIRE(B(-0x7fffffff_b) * B(0x10001_b) == B(-0x80007ffeffff_b));
	REQUIRE(B(-0x7fffffff_b) * B(0x7fffffff_b) == B(-0x3fffffff00000001_b));
	REQUIRE(B(-0x7fffffff_b) * B(0x80000000_b) == B(-0x3fffffff80000000_b));
	REQUIRE(B(-0x7fffffff_b) * B(0x80000001_b) == B(-0x3fffffffffffffff_b));
	REQUIRE(B(-0x7fffffff_b) * B(0xffffffff_b) == B(-0x7ffffffe80000001_b));
	REQUIRE(B(-0x7fffffff_b) * B(0x100000000_b) == B(-0x7fffffff00000000_b));
	REQUIRE(B(-0x7fffffff_b) * B(0x100000001_b) == B(-0x7fffffff7fffffff_b));
	REQUIRE(B(-0x10001_b) * B(-0x100000001_b) == B(0x1000100010001_b));
	REQUIRE(B(-0x10001_b) * B(-0x100000000_b) == B(0x1000100000000_b));
	REQUIRE(B(-0x10001_b) * B(-0xffffffff_b) == B(0x10000fffeffff_b));
	REQUIRE(B(-0x10001_b) * B(-0x80000001_b) == B(0x800080010001_b));
	REQUIRE(B(-0x10001_b) * B(-0x80000000_b) == B(0x800080000000_b));
	REQUIRE(B(-0x10001_b) * B(-0x7fffffff_b) == B(0x80007ffeffff_b));
	REQUIRE(B(-0x10001_b) * B(-0x10001_b) == B(0x100020001_b));
	REQUIRE(B(-0x10001_b) * B(-0x10000_b) == B(0x100010000_b));
	REQUIRE(B(-0x10001_b) * B(-0xffff_b) == B(0xffffffff_b));
	REQUIRE(B(-0x10001_b) * B(-0x8001_b) == B(0x80018001_b));
	REQUIRE(B(-0x10001_b) * B(-0x8000_b) == B(0x80008000_b));
	REQUIRE(B(-0x10001_b) * B(-0x7fff_b) == B(0x7fff7fff_b));
	REQUIRE(B(-0x10001_b) * B(0x7fff_b) == B(-0x7fff7fff_b));
	REQUIRE(B(-0x10001_b) * B(0x8000_b) == B(-0x80008000_b));
	REQUIRE(B(-0x10001_b) * B(0x8001_b) == B(-0x80018001_b));
	REQUIRE(B(-0x10001_b) * B(0xffff_b) == B(-0xffffffff_b));
	REQUIRE(B(-0x10001_b) * B(0x10000_b) == B(-0x100010000_b));
	REQUIRE(B(-0x10001_b) * B(0x10001_b) == B(-0x100020001_b));
	REQUIRE(B(-0x10001_b) * B(0x7fffffff_b) == B(-0x80007ffeffff_b));
	REQUIRE(B(-0x10001_b) * B(0x80000000_b) == B(-0x800080000000_b));
	REQUIRE(B(-0x10001_b) * B(0x80000001_b) == B(-0x800080010001_b));
	REQUIRE(B(-0x10001_b) * B(0xffffffff_b) == B(-0x10000fffeffff_b));
	REQUIRE(B(-0x10001_b) * B(0x100000000_b) == B(-0x1000100000000_b));
	REQUIRE(B(-0x10001_b) * B(0x100000001_b) == B(-0x1000100010001_b));
	REQUIRE(B(-0x10000_b) * B(-0x100000001_b) == B(0x1000000010000_b));
	REQUIRE(B(-0x10000_b) * B(-0x100000000_b) == B(0x1000000000000_b));
	REQUIRE(B(-0x10000_b) * B(-0xffffffff_b) == B(0xffffffff0000_b));
	REQUIRE(B(-0x10000_b) * B(-0x80000001_b) == B(0x800000010000_b));
	REQUIRE(B(-0x10000_b) * B(-0x80000000_b) == B(0x800000000000_b));
	REQUIRE(B(-0x10000_b) * B(-0x7fffffff_b) == B(0x7fffffff0000_b));
	REQUIRE(B(-0x10000_b) * B(-0x10001_b) == B(0x100010000_b));
	REQUIRE(B(-0x10000_b) * B(-0x10000_b) == B(0x100000000_b));
	REQUIRE(B(-0x10000_b) * B(-0xffff_b) == B(0xffff0000_b));
	REQUIRE(B(-0x10000_b) * B(-0x8001_b) == B(0x80010000_b));
	REQUIRE(B(-0x10000_b) * B(-0x8000_b) == B(0x80000000_b));
	REQUIRE(B(-0x10000_b) * B(-0x7fff_b) == B(0x7fff0000_b));
	REQUIRE(B(-0x10000_b) * B(0x7fff_b) == B(-0x7fff0000_b));
	REQUIRE(B(-0x10000_b) * B(0x8000_b) == B(-0x80000000_b));
	REQUIRE(B(-0x10000_b) * B(0x8001_b) == B(-0x80010000_b));
	REQUIRE(B(-0x10000_b) * B(0xffff_b) == B(-0xffff0000_b));
	REQUIRE(B(-0x10000_b) * B(0x10000_b) == B(-0x100000000_b));
	REQUIRE(B(-0x10000_b) * B(0x10001_b) == B(-0x100010000_b));
	REQUIRE(B(-0x10000_b) * B(0x7fffffff_b) == B(-0x7fffffff0000_b));
	REQUIRE(B(-0x10000_b) * B(0x80000000_b) == B(-0x800000000000_b));
	REQUIRE(B(-0x10000_b) * B(0x80000001_b) == B(-0x800000010000_b));
	REQUIRE(B(-0x10000_b) * B(0xffffffff_b) == B(-0xffffffff0000_b));
	REQUIRE(B(-0x10000_b) * B(0x100000000_b) == B(-0x1000000000000_b));
	REQUIRE(B(-0x10000_b) * B(0x100000001_b) == B(-0x1000000010000_b));
	REQUIRE(B(-0xffff_b) * B(-0x100000001_b) == B(0xffff0000ffff_b));
	REQUIRE(B(-0xffff_b) * B(-0x100000000_b) == B(0xffff00000000_b));
	REQUIRE(B(-0xffff_b) * B(-0xffffffff_b) == B(0xfffeffff0001_b));
	REQUIRE(B(-0xffff_b) * B(-0x80000001_b) == B(0x7fff8000ffff_b));
	REQUIRE(B(-0xffff_b) * B(-0x80000000_b) == B(0x7fff80000000_b));
	REQUIRE(B(-0xffff_b) * B(-0x7fffffff_b) == B(0x7fff7fff0001_b));
	REQUIRE(B(-0xffff_b) * B(-0x10001_b) == B(0xffffffff_b));
	REQUIRE(B(-0xffff_b) * B(-0x10000_b) == B(0xffff0000_b));
	REQUIRE(B(-0xffff_b) * B(-0xffff_b) == B(0xfffe0001_b));
	REQUIRE(B(-0xffff_b) * B(-0x8001_b) == B(0x80007fff_b));
	REQUIRE(B(-0xffff_b) * B(-0x8000_b) == B(0x7fff8000_b));
	REQUIRE(B(-0xffff_b) * B(-0x7fff_b) == B(0x7ffe8001_b));
	REQUIRE(B(-0xffff_b) * B(0x7fff_b) == B(-0x7ffe8001_b));
	REQUIRE(B(-0xffff_b) * B(0x8000_b) == B(-0x7fff8000_b));
	REQUIRE(B(-0xffff_b) * B(0x8001_b) == B(-0x80007fff_b));
	REQUIRE(B(-0xffff_b) * B(0xffff_b) == B(-0xfffe0001_b));
	REQUIRE(B(-0xffff_b) * B(0x10000_b) == B(-0xffff0000_b));
	REQUIRE(B(-0xffff_b) * B(0x10001_b) == B(-0xffffffff_b));
	REQUIRE(B(-0xffff_b) * B(0x7fffffff_b) == B(-0x7fff7fff0001_b));
	REQUIRE(B(-0xffff_b) * B(0x80000000_b) == B(-0x7fff80000000_b));
	REQUIRE(B(-0xffff_b) * B(0x80000001_b) == B(-0x7fff8000ffff_b));
	REQUIRE(B(-0xffff_b) * B(0xffffffff_b) == B(-0xfffeffff0001_b));
	REQUIRE(B(-0xffff_b) * B(0x100000000_b) == B(-0xffff00000000_b));
	REQUIRE(B(-0xffff_b) * B(0x100000001_b) == B(-0xffff0000ffff_b));
	REQUIRE(B(-0x8001_b) * B(-0x100000001_b) == B(0x800100008001_b));
	REQUIRE(B(-0x8001_b) * B(-0x100000000_b) == B(0x800100000000_b));
	REQUIRE(B(-0x8001_b) * B(-0xffffffff_b) == B(0x8000ffff7fff_b));
	REQUIRE(B(-0x8001_b) * B(-0x80000001_b) == B(0x400080008001_b));
	REQUIRE(B(-0x8001_b) * B(-0x80000000_b) == B(0x400080000000_b));
	REQUIRE(B(-0x8001_b) * B(-0x7fffffff_b) == B(0x40007fff7fff_b));
	REQUIRE(B(-0x8001_b) * B(-0x10001_b) == B(0x80018001_b));
	REQUIRE(B(-0x8001_b) * B(-0x10000_b) == B(0x80010000_b));
	REQUIRE(B(-0x8001_b) * B(-0xffff_b) == B(0x80007fff_b));
	REQUIRE(B(-0x8001_b) * B(-0x8001_b) == B(0x40010001_b));
	REQUIRE(B(-0x8001_b) * B(-0x8000_b) == B(0x40008000_b));
	REQUIRE(B(-0x8001_b) * B(-0x7fff_b) == B(0x3fffffff_b));
	REQUIRE(B(-0x8001_b) * B(0x7fff_b) == B(-0x3fffffff_b));
	REQUIRE(B(-0x8001_b) * B(0x8000_b) == B(-0x40008000_b));
	REQUIRE(B(-0x8001_b) * B(0x8001_b) == B(-0x40010001_b));
	REQUIRE(B(-0x8001_b) * B(0xffff_b) == B(-0x80007fff_b));
	REQUIRE(B(-0x8001_b) * B(0x10000_b) == B(-0x80010000_b));
	REQUIRE(B(-0x8001_b) * B(0x10001_b) == B(-0x80018001_b));
	REQUIRE(B(-0x8001_b) * B(0x7fffffff_b) == B(-0x40007fff7fff_b));
	REQUIRE(B(-0x8001_b) * B(0x80000000_b) == B(-0x400080000000_b));
	REQUIRE(B(-0x8001_b) * B(0x80000001_b) == B(-0x400080008001_b));
	REQUIRE(B(-0x8001_b) * B(0xffffffff_b) == B(-0x8000ffff7fff_b));
	REQUIRE(B(-0x8001_b) * B(0x100000000_b) == B(-0x800100000000_b));
	REQUIRE(B(-0x8001_b) * B(0x100000001_b) == B(-0x800100008001_b));
	REQUIRE(B(-0x8000_b) * B(-0x100000001_b) == B(0x800000008000_b));
	REQUIRE(B(-0x8000_b) * B(-0x100000000_b) == B(0x800000000000_b));
	REQUIRE(B(-0x8000_b) * B(-0xffffffff_b) == B(0x7fffffff8000_b));
	REQUIRE(B(-0x8000_b) * B(-0x80000001_b) == B(0x400000008000_b));
	REQUIRE(B(-0x8000_b) * B(-0x80000000_b) == B(0x400000000000_b));
	REQUIRE(B(-0x8000_b) * B(-0x7fffffff_b) == B(0x3fffffff8000_b));
	REQUIRE(B(-0x8000_b) * B(-0x10001_b) == B(0x80008000_b));
	REQUIRE(B(-0x8000_b) * B(-0x10000_b) == B(0x80000000_b));
	REQUIRE(B(-0x8000_b) * B(-0xffff_b) == B(0x7fff8000_b));
	REQUIRE(B(-0x8000_b) * B(-0x8001_b) == B(0x40008000_b));
	REQUIRE(B(-0x8000_b) * B(-0x8000_b) == B(0x40000000_b));
	REQUIRE(B(-0x8000_b) * B(-0x7fff_b) == B(0x3fff8000_b));
	REQUIRE(B(-0x8000_b) * B(0x7fff_b) == B(-0x3fff8000_b));
	REQUIRE(B(-0x8000_b) * B(0x8000_b) == B(-0x40000000_b));
	REQUIRE(B(-0x8000_b) * B(0x8001_b) == B(-0x40008000_b));
	REQUIRE(B(-0x8000_b) * B(0xffff_b) == B(-0x7fff8000_b));
	REQUIRE(B(-0x8000_b) * B(0x10000_b) == B(-0x80000000_b));
	REQUIRE(B(-0x8000_b) * B(0x10001_b) == B(-0x80008000_b));
	REQUIRE(B(-0x8000_b) * B(0x7fffffff_b) == B(-0x3fffffff8000_b));
	REQUIRE(B(-0x8000_b) * B(0x80000000_b) == B(-0x400000000000_b));
	REQUIRE(B(-0x8000_b) * B(0x80000001_b) == B(-0x400000008000_b));
	REQUIRE(B(-0x8000_b) * B(0xffffffff_b) == B(-0x7fffffff8000_b));
	REQUIRE(B(-0x8000_b) * B(0x100000000_b) == B(-0x800000000000_b));
	REQUIRE(B(-0x8000_b) * B(0x100000001_b) == B(-0x800000008000_b));
	REQUIRE(B(-0x7fff_b) * B(-0x100000001_b) == B(0x7fff00007fff_b));
	REQUIRE(B(-0x7fff_b) * B(-0x100000000_b) == B(0x7fff00000000_b));
	REQUIRE(B(-0x7fff_b) * B(-0xffffffff_b) == B(0x7ffeffff8001_b));
	REQUIRE(B(-0x7fff_b) * B(-0x80000001_b) == B(0x3fff80007fff_b));
	REQUIRE(B(-0x7fff_b) * B(-0x80000000_b) == B(0x3fff80000000_b));
	REQUIRE(B(-0x7fff_b) * B(-0x7fffffff_b) == B(0x3fff7fff8001_b));
	REQUIRE(B(-0x7fff_b) * B(-0x10001_b) == B(0x7fff7fff_b));
	REQUIRE(B(-0x7fff_b) * B(-0x10000_b) == B(0x7fff0000_b));
	REQUIRE(B(-0x7fff_b) * B(-0xffff_b) == B(0x7ffe8001_b));
	REQUIRE(B(-0x7fff_b) * B(-0x8001_b) == B(0x3fffffff_b));
	REQUIRE(B(-0x7fff_b) * B(-0x8000_b) == B(0x3fff8000_b));
	REQUIRE(B(-0x7fff_b) * B(-0x7fff_b) == B(0x3fff0001_b));
	REQUIRE(B(-0x7fff_b) * B(0x7fff_b) == B(-0x3fff0001_b));
	REQUIRE(B(-0x7fff_b) * B(0x8000_b) == B(-0x3fff8000_b));
	REQUIRE(B(-0x7fff_b) * B(0x8001_b) == B(-0x3fffffff_b));
	REQUIRE(B(-0x7fff_b) * B(0xffff_b) == B(-0x7ffe8001_b));
	REQUIRE(B(-0x7fff_b) * B(0x10000_b) == B(-0x7fff0000_b));
	REQUIRE(B(-0x7fff_b) * B(0x10001_b) == B(-0x7fff7fff_b));
	REQUIRE(B(-0x7fff_b) * B(0x7fffffff_b) == B(-0x3fff7fff8001_b));
	REQUIRE(B(-0x7fff_b) * B(0x80000000_b) == B(-0x3fff80000000_b));
	REQUIRE(B(-0x7fff_b) * B(0x80000001_b) == B(-0x3fff80007fff_b));
	REQUIRE(B(-0x7fff_b) * B(0xffffffff_b) == B(-0x7ffeffff8001_b));
	REQUIRE(B(-0x7fff_b) * B(0x100000000_b) == B(-0x7fff00000000_b));
	REQUIRE(B(-0x7fff_b) * B(0x100000001_b) == B(-0x7fff00007fff_b));
	REQUIRE(B(0x7fff_b) * B(-0x100000001_b) == B(-0x7fff00007fff_b));
	REQUIRE(B(0x7fff_b) * B(-0x100000000_b) == B(-0x7fff00000000_b));
	REQUIRE(B(0x7fff_b) * B(-0xffffffff_b) == B(-0x7ffeffff8001_b));
	REQUIRE(B(0x7fff_b) * B(-0x80000001_b) == B(-0x3fff80007fff_b));
	REQUIRE(B(0x7fff_b) * B(-0x80000000_b) == B(-0x3fff80000000_b));
	REQUIRE(B(0x7fff_b) * B(-0x7fffffff_b) == B(-0x3fff7fff8001_b));
	REQUIRE(B(0x7fff_b) * B(-0x10001_b) == B(-0x7fff7fff_b));
	REQUIRE(B(0x7fff_b) * B(-0x10000_b) == B(-0x7fff0000_b));
	REQUIRE(B(0x7fff_b) * B(-0xffff_b) == B(-0x7ffe8001_b));
	REQUIRE(B(0x7fff_b) * B(-0x8001_b) == B(-0x3fffffff_b));
	REQUIRE(B(0x7fff_b) * B(-0x8000_b) == B(-0x3fff8000_b));
	REQUIRE(B(0x7fff_b) * B(-0x7fff_b) == B(-0x3fff0001_b));
	REQUIRE(B(0x7fff_b) * B(0x7fff_b) == B(0x3fff0001_b));
	REQUIRE(B(0x7fff_b) * B(0x8000_b) == B(0x3fff8000_b));
	REQUIRE(B(0x7fff_b) * B(0x8001_b) == B(0x3fffffff_b));
	REQUIRE(B(0x7fff_b) * B(0xffff_b) == B(0x7ffe8001_b));
	REQUIRE(B(0x7fff_b) * B(0x10000_b) == B(0x7fff0000_b));
	REQUIRE(B(0x7fff_b) * B(0x10001_b) == B(0x7fff7fff_b));
	REQUIRE(B(0x7fff_b) * B(0x7fffffff_b) == B(0x3fff7fff8001_b));
	REQUIRE(B(0x7fff_b) * B(0x80000000_b) == B(0x3fff80000000_b));
	REQUIRE(B(0x7fff_b) * B(0x80000001_b) == B(0x3fff80007fff_b));
	REQUIRE(B(0x7fff_b) * B(0xffffffff_b) == B(0x7ffeffff8001_b));
	REQUIRE(B(0x7fff_b) * B(0x100000000_b) == B(0x7fff00000000_b));
	REQUIRE(B(0x7fff_b) * B(0x100000001_b) == B(0x7fff00007fff_b));
	REQUIRE(B(0x8000_b) * B(-0x100000001_b) == B(-0x800000008000_b));
	REQUIRE(B(0x8000_b) * B(-0x100000000_b) == B(-0x800000000000_b));
	REQUIRE(B(0x8000_b) * B(-0xffffffff_b) == B(-0x7fffffff8000_b));
	REQUIRE(B(0x8000_b) * B(-0x80000001_b) == B(-0x400000008000_b));
	REQUIRE(B(0x8000_b) * B(-0x80000000_b) == B(-0x400000000000_b));
	REQUIRE(B(0x8000_b) * B(-0x7fffffff_b) == B(-0x3fffffff8000_b));
	REQUIRE(B(0x8000_b) * B(-0x10001_b) == B(-0x80008000_b));
	REQUIRE(B(0x8000_b) * B(-0x10000_b) == B(-0x80000000_b));
	REQUIRE(B(0x8000_b) * B(-0xffff_b) == B(-0x7fff8000_b));
	REQUIRE(B(0x8000_b) * B(-0x8001_b) == B(-0x40008000_b));
	REQUIRE(B(0x8000_b) * B(-0x8000_b) == B(-0x40000000_b));
	REQUIRE(B(0x8000_b) * B(-0x7fff_b) == B(-0x3fff8000_b));
	REQUIRE(B(0x8000_b) * B(0x7fff_b) == B(0x3fff8000_b));
	REQUIRE(B(0x8000_b) * B(0x8000_b) == B(0x40000000_b));
	REQUIRE(B(0x8000_b) * B(0x8001_b) == B(0x40008000_b));
	REQUIRE(B(0x8000_b) * B(0xffff_b) == B(0x7fff8000_b));
	REQUIRE(B(0x8000_b) * B(0x10000_b) == B(0x80000000_b));
	REQUIRE(B(0x8000_b) * B(0x10001_b) == B(0x80008000_b));
	REQUIRE(B(0x8000_b) * B(0x7fffffff_b) == B(0x3fffffff8000_b));
	REQUIRE(B(0x8000_b) * B(0x80000000_b) == B(0x400000000000_b));
	REQUIRE(B(0x8000_b) * B(0x80000001_b) == B(0x400000008000_b));
	REQUIRE(B(0x8000_b) * B(0xffffffff_b) == B(0x7fffffff8000_b));
	REQUIRE(B(0x8000_b) * B(0x100000000_b) == B(0x800000000000_b));
	REQUIRE(B(0x8000_b) * B(0x100000001_b) == B(0x800000008000_b));
	REQUIRE(B(0x8001_b) * B(-0x100000001_b) == B(-0x800100008001_b));
	REQUIRE(B(0x8001_b) * B(-0x100000000_b) == B(-0x800100000000_b));
	REQUIRE(B(0x8001_b) * B(-0xffffffff_b) == B(-0x8000ffff7fff_b));
	REQUIRE(B(0x8001_b) * B(-0x80000001_b) == B(-0x400080008001_b));
	REQUIRE(B(0x8001_b) * B(-0x80000000_b) == B(-0x400080000000_b));
	REQUIRE(B(0x8001_b) * B(-0x7fffffff_b) == B(-0x40007fff7fff_b));
	REQUIRE(B(0x8001_b) * B(-0x10001_b) == B(-0x80018001_b));
	REQUIRE(B(0x8001_b) * B(-0x10000_b) == B(-0x80010000_b));
	REQUIRE(B(0x8001_b) * B(-0xffff_b) == B(-0x80007fff_b));
	REQUIRE(B(0x8001_b) * B(-0x8001_b) == B(-0x40010001_b));
	REQUIRE(B(0x8001_b) * B(-0x8000_b) == B(-0x40008000_b));
	REQUIRE(B(0x8001_b) * B(-0x7fff_b) == B(-0x3fffffff_b));
	REQUIRE(B(0x8001_b) * B(0x7fff_b) == B(0x3fffffff_b));
	REQUIRE(B(0x8001_b) * B(0x8000_b) == B(0x40008000_b));
	REQUIRE(B(0x8001_b) * B(0x8001_b) == B(0x40010001_b));
	REQUIRE(B(0x8001_b) * B(0xffff_b) == B(0x80007fff_b));
	REQUIRE(B(0x8001_b) * B(0x10000_b) == B(0x80010000_b));
	REQUIRE(B(0x8001_b) * B(0x10001_b) == B(0x80018001_b));
	REQUIRE(B(0x8001_b) * B(0x7fffffff_b) == B(0x40007fff7fff_b));
	REQUIRE(B(0x8001_b) * B(0x80000000_b) == B(0x400080000000_b));
	REQUIRE(B(0x8001_b) * B(0x80000001_b) == B(0x400080008001_b));
	REQUIRE(B(0x8001_b) * B(0xffffffff_b) == B(0x8000ffff7fff_b));
	REQUIRE(B(0x8001_b) * B(0x100000000_b) == B(0x800100000000_b));
	REQUIRE(B(0x8001_b) * B(0x100000001_b) == B(0x800100008001_b));
	REQUIRE(B(0xffff_b) * B(-0x100000001_b) == B(-0xffff0000ffff_b));
	REQUIRE(B(0xffff_b) * B(-0x100000000_b) == B(-0xffff00000000_b));
	REQUIRE(B(0xffff_b) * B(-0xffffffff_b) == B(-0xfffeffff0001_b));
	REQUIRE(B(0xffff_b) * B(-0x80000001_b) == B(-0x7fff8000ffff_b));
	REQUIRE(B(0xffff_b) * B(-0x80000000_b) == B(-0x7fff80000000_b));
	REQUIRE(B(0xffff_b) * B(-0x7fffffff_b) == B(-0x7fff7fff0001_b));
	REQUIRE(B(0xffff_b) * B(-0x10001_b) == B(-0xffffffff_b));
	REQUIRE(B(0xffff_b) * B(-0x10000_b) == B(-0xffff0000_b));
	REQUIRE(B(0xffff_b) * B(-0xffff_b) == B(-0xfffe0001_b));
	REQUIRE(B(0xffff_b) * B(-0x8001_b) == B(-0x80007fff_b));
	REQUIRE(B(0xffff_b) * B(-0x8000_b) == B(-0x7fff8000_b));
	REQUIRE(B(0xffff_b) * B(-0x7fff_b) == B(-0x7ffe8001_b));
	REQUIRE(B(0xffff_b) * B(0x7fff_b) == B(0x7ffe8001_b));
	REQUIRE(B(0xffff_b) * B(0x8000_b) == B(0x7fff8000_b));
	REQUIRE(B(0xffff_b) * B(0x8001_b) == B(0x80007fff_b));
	REQUIRE(B(0xffff_b) * B(0xffff_b) == B(0xfffe0001_b));
	REQUIRE(B(0xffff_b) * B(0x10000_b) == B(0xffff0000_b));
	REQUIRE(B(0xffff_b) * B(0x10001_b) == B(0xffffffff_b));
	REQUIRE(B(0xffff_b) * B(0x7fffffff_b) == B(0x7fff7fff0001_b));
	REQUIRE(B(0xffff_b) * B(0x80000000_b) == B(0x7fff80000000_b));
	REQUIRE(B(0xffff_b) * B(0x80000001_b) == B(0x7fff8000ffff_b));
	REQUIRE(B(0xffff_b) * B(0xffffffff_b) == B(0xfffeffff0001_b));
	REQUIRE(B(0xffff_b) * B(0x100000000_b) == B(0xffff00000000_b));
	REQUIRE(B(0xffff_b) * B(0x100000001_b) == B(0xffff0000ffff_b));
	REQUIRE(B(0x10000_b) * B(-0x100000001_b) == B(-0x1000000010000_b));
	REQUIRE(B(0x10000_b) * B(-0x100000000_b) == B(-0x1000000000000_b));
	REQUIRE(B(0x10000_b) * B(-0xffffffff_b) == B(-0xffffffff0000_b));
	REQUIRE(B(0x10000_b) * B(-0x80000001_b) == B(-0x800000010000_b));
	REQUIRE(B(0x10000_b) * B(-0x80000000_b) == B(-0x800000000000_b));
	REQUIRE(B(0x10000_b) * B(-0x7fffffff_b) == B(-0x7fffffff0000_b));
	REQUIRE(B(0x10000_b) * B(-0x10001_b) == B(-0x100010000_b));
	REQUIRE(B(0x10000_b) * B(-0x10000_b) == B(-0x100000000_b));
	REQUIRE(B(0x10000_b) * B(-0xffff_b) == B(-0xffff0000_b));
	REQUIRE(B(0x10000_b) * B(-0x8001_b) == B(-0x80010000_b));
	REQUIRE(B(0x10000_b) * B(-0x8000_b) == B(-0x80000000_b));
	REQUIRE(B(0x10000_b) * B(-0x7fff_b) == B(-0x7fff0000_b));
	REQUIRE(B(0x10000_b) * B(0x7fff_b) == B(0x7fff0000_b));
	REQUIRE(B(0x10000_b) * B(0x8000_b) == B(0x80000000_b));
	REQUIRE(B(0x10000_b) * B(0x8001_b) == B(0x80010000_b));
	REQUIRE(B(0x10000_b) * B(0xffff_b) == B(0xffff0000_b));
	REQUIRE(B(0x10000_b) * B(0x10000_b) == B(0x100000000_b));
	REQUIRE(B(0x10000_b) * B(0x10001_b) == B(0x100010000_b));
	REQUIRE(B(0x10000_b) * B(0x7fffffff_b) == B(0x7fffffff0000_b));
	REQUIRE(B(0x10000_b) * B(0x80000000_b) == B(0x800000000000_b));
	REQUIRE(B(0x10000_b) * B(0x80000001_b) == B(0x800000010000_b));
	REQUIRE(B(0x10000_b) * B(0xffffffff_b) == B(0xffffffff0000_b));
	REQUIRE(B(0x10000_b) * B(0x100000000_b) == B(0x1000000000000_b));
	REQUIRE(B(0x10000_b) * B(0x100000001_b) == B(0x1000000010000_b));
	REQUIRE(B(0x10001_b) * B(-0x100000001_b) == B(-0x1000100010001_b));
	REQUIRE(B(0x10001_b) * B(-0x100000000_b) == B(-0x1000100000000_b));
	REQUIRE(B(0x10001_b) * B(-0xffffffff_b) == B(-0x10000fffeffff_b));
	REQUIRE(B(0x10001_b) * B(-0x80000001_b) == B(-0x800080010001_b));
	REQUIRE(B(0x10001_b) * B(-0x80000000_b) == B(-0x800080000000_b));
	REQUIRE(B(0x10001_b) * B(-0x7fffffff_b) == B(-0x80007ffeffff_b));
	REQUIRE(B(0x10001_b) * B(-0x10001_b) == B(-0x100020001_b));
	REQUIRE(B(0x10001_b) * B(-0x10000_b) == B(-0x100010000_b));
	REQUIRE(B(0x10001_b) * B(-0xffff_b) == B(-0xffffffff_b));
	REQUIRE(B(0x10001_b) * B(-0x8001_b) == B(-0x80018001_b));
	REQUIRE(B(0x10001_b) * B(-0x8000_b) == B(-0x80008000_b));
	REQUIRE(B(0x10001_b) * B(-0x7fff_b) == B(-0x7fff7fff_b));
	REQUIRE(B(0x10001_b) * B(0x7fff_b) == B(0x7fff7fff_b));
	REQUIRE(B(0x10001_b) * B(0x8000_b) == B(0x80008000_b));
	REQUIRE(B(0x10001_b) * B(0x8001_b) == B(0x80018001_b));
	REQUIRE(B(0x10001_b) * B(0xffff_b) == B(0xffffffff_b));
	REQUIRE(B(0x10001_b) * B(0x10000_b) == B(0x100010000_b));
	REQUIRE(B(0x10001_b) * B(0x10001_b) == B(0x100020001_b));
	REQUIRE(B(0x10001_b) * B(0x7fffffff_b) == B(0x80007ffeffff_b));
	REQUIRE(B(0x10001_b) * B(0x80000000_b) == B(0x800080000000_b));
	REQUIRE(B(0x10001_b) * B(0x80000001_b) == B(0x800080010001_b));
	REQUIRE(B(0x10001_b) * B(0xffffffff_b) == B(0x10000fffeffff_b));
	REQUIRE(B(0x10001_b) * B(0x100000000_b) == B(0x1000100000000_b));
	REQUIRE(B(0x10001_b) * B(0x100000001_b) == B(0x1000100010001_b));
	REQUIRE(B(0x7fffffff_b) * B(-0x100000001_b) == B(-0x7fffffff7fffffff_b));
	REQUIRE(B(0x7fffffff_b) * B(-0x100000000_b) == B(-0x7fffffff00000000_b));
	REQUIRE(B(0x7fffffff_b) * B(-0xffffffff_b) == B(-0x7ffffffe80000001_b));
	REQUIRE(B(0x7fffffff_b) * B(-0x80000001_b) == B(-0x3fffffffffffffff_b));
	REQUIRE(B(0x7fffffff_b) * B(-0x80000000_b) == B(-0x3fffffff80000000_b));
	REQUIRE(B(0x7fffffff_b) * B(-0x7fffffff_b) == B(-0x3fffffff00000001_b));
	REQUIRE(B(0x7fffffff_b) * B(-0x10001_b) == B(-0x80007ffeffff_b));
	REQUIRE(B(0x7fffffff_b) * B(-0x10000_b) == B(-0x7fffffff0000_b));
	REQUIRE(B(0x7fffffff_b) * B(-0xffff_b) == B(-0x7fff7fff0001_b));
	REQUIRE(B(0x7fffffff_b) * B(-0x8001_b) == B(-0x40007fff7fff_b));
	REQUIRE(B(0x7fffffff_b) * B(-0x8000_b) == B(-0x3fffffff8000_b));
	REQUIRE(B(0x7fffffff_b) * B(-0x7fff_b) == B(-0x3fff7fff8001_b));
	REQUIRE(B(0x7fffffff_b) * B(0x7fff_b) == B(0x3fff7fff8001_b));
	REQUIRE(B(0x7fffffff_b) * B(0x8000_b) == B(0x3fffffff8000_b));
	REQUIRE(B(0x7fffffff_b) * B(0x8001_b) == B(0x40007fff7fff_b));
	REQUIRE(B(0x7fffffff_b) * B(0xffff_b) == B(0x7fff7fff0001_b));
	REQUIRE(B(0x7fffffff_b) * B(0x10000_b) == B(0x7fffffff0000_b));
	REQUIRE(B(0x7fffffff_b) * B(0x10001_b) == B(0x80007ffeffff_b));
	REQUIRE(B(0x7fffffff_b) * B(0x7fffffff_b) == B(0x3fffffff00000001_b));
	REQUIRE(B(0x7fffffff_b) * B(0x80000000_b) == B(0x3fffffff80000000_b));
	REQUIRE(B(0x7fffffff_b) * B(0x80000001_b) == B(0x3fffffffffffffff_b));
	REQUIRE(B(0x7fffffff_b) * B(0xffffffff_b) == B(0x7ffffffe80000001_b));
	REQUIRE(B(0x7fffffff_b) * B(0x100000000_b) == B(0x7fffffff00000000_b));
	REQUIRE(B(0x7fffffff_b) * B(0x100000001_b) == B(0x7fffffff7fffffff_b));
	REQUIRE(B(0x80000000_b) * B(-0x100000001_b) == B(-0x8000000080000000_b));
	REQUIRE(B(0x80000000_b) * B(-0x100000000_b) == B(-0x8000000000000000_b));
	REQUIRE(B(0x80000000_b) * B(-0xffffffff_b) == B(-0x7fffffff80000000_b));
	REQUIRE(B(0x80000000_b) * B(-0x80000001_b) == B(-0x4000000080000000_b));
	REQUIRE(B(0x80000000_b) * B(-0x80000000_b) == B(-0x4000000000000000_b));
	REQUIRE(B(0x80000000_b) * B(-0x7fffffff_b) == B(-0x3fffffff80000000_b));
	REQUIRE(B(0x80000000_b) * B(-0x10001_b) == B(-0x800080000000_b));
	REQUIRE(B(0x80000000_b) * B(-0x10000_b) == B(-0x800000000000_b));
	REQUIRE(B(0x80000000_b) * B(-0xffff_b) == B(-0x7fff80000000_b));
	REQUIRE(B(0x80000000_b) * B(-0x8001_b) == B(-0x400080000000_b));
	REQUIRE(B(0x80000000_b) * B(-0x8000_b) == B(-0x400000000000_b));
	REQUIRE(B(0x80000000_b) * B(-0x7fff_b) == B(-0x3fff80000000_b));
	REQUIRE(B(0x80000000_b) * B(0x7fff_b) == B(0x3fff80000000_b));
	REQUIRE(B(0x80000000_b) * B(0x8000_b) == B(0x400000000000_b));
	REQUIRE(B(0x80000000_b) * B(0x8001_b) == B(0x400080000000_b));
	REQUIRE(B(0x80000000_b) * B(0xffff_b) == B(0x7fff80000000_b));
	REQUIRE(B(0x80000000_b) * B(0x10000_b) == B(0x800000000000_b));
	REQUIRE(B(0x80000000_b) * B(0x10001_b) == B(0x800080000000_b));
	REQUIRE(B(0x80000000_b) * B(0x7fffffff_b) == B(0x3fffffff80000000_b));
	REQUIRE(B(0x80000000_b) * B(0x80000000_b) == B(0x4000000000000000_b));
	REQUIRE(B(0x80000000_b) * B(0x80000001_b) == B(0x4000000080000000_b));
	REQUIRE(B(0x80000000_b) * B(0xffffffff_b) == B(0x7fffffff80000000_b));
	REQUIRE(B(0x80000000_b) * B(0x100000000_b) == B(0x8000000000000000_b));
	REQUIRE(B(0x80000000_b) * B(0x100000001_b) == B(0x8000000080000000_b));
	REQUIRE(B(0x80000001_b) * B(-0x100000001_b) == B(-0x8000000180000001_b));
	REQUIRE(B(0x80000001_b) * B(-0x100000000_b) == B(-0x8000000100000000_b));
	REQUIRE(B(0x80000001_b) * B(-0xffffffff_b) == B(-0x800000007fffffff_b));
	REQUIRE(B(0x80000001_b) * B(-0x80000001_b) == B(-0x4000000100000001_b));
	REQUIRE(B(0x80000001_b) * B(-0x80000000_b) == B(-0x4000000080000000_b));
	REQUIRE(B(0x80000001_b) * B(-0x7fffffff_b) == B(-0x3fffffffffffffff_b));
	REQUIRE(B(0x80000001_b) * B(-0x10001_b) == B(-0x800080010001_b));
	REQUIRE(B(0x80000001_b) * B(-0x10000_b) == B(-0x800000010000_b));
	REQUIRE(B(0x80000001_b) * B(-0xffff_b) == B(-0x7fff8000ffff_b));
	REQUIRE(B(0x80000001_b) * B(-0x8001_b) == B(-0x400080008001_b));
	REQUIRE(B(0x80000001_b) * B(-0x8000_b) == B(-0x400000008000_b));
	REQUIRE(B(0x80000001_b) * B(-0x7fff_b) == B(-0x3fff80007fff_b));
	REQUIRE(B(0x80000001_b) * B(0x7fff_b) == B(0x3fff80007fff_b));
	REQUIRE(B(0x80000001_b) * B(0x8000_b) == B(0x400000008000_b));
	REQUIRE(B(0x80000001_b) * B(0x8001_b) == B(0x400080008001_b));
	REQUIRE(B(0x80000001_b) * B(0xffff_b) == B(0x7fff8000ffff_b));
	REQUIRE(B(0x80000001_b) * B(0x10000_b) == B(0x800000010000_b));
	REQUIRE(B(0x80000001_b) * B(0x10001_b) == B(0x800080010001_b));
	REQUIRE(B(0x80000001_b) * B(0x7fffffff_b) == B(0x3fffffffffffffff_b));
	REQUIRE(B(0x80000001_b) * B(0x80000000_b) == B(0x4000000080000000_b));
	REQUIRE(B(0x80000001_b) * B(0x80000001_b) == B(0x4000000100000001_b));
	REQUIRE(B(0x80000001_b) * B(0xffffffff_b) == B(0x800000007fffffff_b));
	REQUIRE(B(0x80000001_b) * B(0x100000000_b) == B(0x8000000100000000_b));
	REQUIRE(B(0x80000001_b) * B(0x100000001_b) == B(0x8000000180000001_b));
	REQUIRE(B(0xffffffff_b) * B(-0x100000001_b) == B(-0xffffffffffffffff_b));
	REQUIRE(B(0xffffffff_b) * B(-0x100000000_b) == B(-0xffffffff00000000_b));
	REQUIRE(B(0xffffffff_b) * B(-0xffffffff_b) == B(-0xfffffffe00000001_b));
	REQUIRE(B(0xffffffff_b) * B(-0x80000001_b) == B(-0x800000007fffffff_b));
	REQUIRE(B(0xffffffff_b) * B(-0x80000000_b) == B(-0x7fffffff80000000_b));
	REQUIRE(B(0xffffffff_b) * B(-0x7fffffff_b) == B(-0x7ffffffe80000001_b));
	REQUIRE(B(0xffffffff_b) * B(-0x10001_b) == B(-0x10000fffeffff_b));
	REQUIRE(B(0xffffffff_b) * B(-0x10000_b) == B(-0xffffffff0000_b));
	REQUIRE(B(0xffffffff_b) * B(-0xffff_b) == B(-0xfffeffff0001_b));
	REQUIRE(B(0xffffffff_b) * B(-0x8001_b) == B(-0x8000ffff7fff_b));
	REQUIRE(B(0xffffffff_b) * B(-0x8000_b) == B(-0x7fffffff8000_b));
	REQUIRE(B(0xffffffff_b) * B(-0x7fff_b) == B(-0x7ffeffff8001_b));
	REQUIRE(B(0xffffffff_b) * B(0x7fff_b) == B(0x7ffeffff8001_b));
	REQUIRE(B(0xffffffff_b) * B(0x8000_b) == B(0x7fffffff8000_b));
	REQUIRE(B(0xffffffff_b) * B(0x8001_b) == B(0x8000ffff7fff_b));
	REQUIRE(B(0xffffffff_b) * B(0xffff_b) == B(0xfffeffff0001_b));
	REQUIRE(B(0xffffffff_b) * B(0x10000_b) == B(0xffffffff0000_b));
	REQUIRE(B(0xffffffff_b) * B(0x10001_b) == B(0x10000fffeffff_b));
	REQUIRE(B(0xffffffff_b) * B(0x7fffffff_b) == B(0x7ffffffe80000001_b));
	REQUIRE(B(0xffffffff_b) * B(0x80000000_b) == B(0x7fffffff80000000_b));
	REQUIRE(B(0xffffffff_b) * B(0x80000001_b) == B(0x800000007fffffff_b));
	REQUIRE(B(0xffffffff_b) * B(0xffffffff_b) == B(0xfffffffe00000001_b));
	REQUIRE(B(0xffffffff_b) * B(0x100000000_b) == B(0xffffffff00000000_b));
	REQUIRE(B(0xffffffff_b) * B(0x100000001_b) == B(0xffffffffffffffff_b));
	REQUIRE(B(0x100000000_b) * B(-0x100000001_b) == B(-0x10000000100000000_b));
	REQUIRE(B(0x100000000_b) * B(-0x100000000_b) == B(-0x10000000000000000_b));
	REQUIRE(B(0x100000000_b) * B(-0xffffffff_b) == B(-0xffffffff00000000_b));
	REQUIRE(B(0x100000000_b) * B(-0x80000001_b) == B(-0x8000000100000000_b));
	REQUIRE(B(0x100000000_b) * B(-0x80000000_b) == B(-0x8000000000000000_b));
	REQUIRE(B(0x100000000_b) * B(-0x7fffffff_b) == B(-0x7fffffff00000000_b));
	REQUIRE(B(0x100000000_b) * B(-0x10001_b) == B(-0x1000100000000_b));
	REQUIRE(B(0x100000000_b) * B(-0x10000_b) == B(-0x1000000000000_b));
	REQUIRE(B(0x100000000_b) * B(-0xffff_b) == B(-0xffff00000000_b));
	REQUIRE(B(0x100000000_b) * B(-0x8001_b) == B(-0x800100000000_b));
	REQUIRE(B(0x100000000_b) * B(-0x8000_b) == B(-0x800000000000_b));
	REQUIRE(B(0x100000000_b) * B(-0x7fff_b) == B(-0x7fff00000000_b));
	REQUIRE(B(0x100000000_b) * B(0x7fff_b) == B(0x7fff00000000_b));
	REQUIRE(B(0x100000000_b) * B(0x8000_b) == B(0x800000000000_b));
	REQUIRE(B(0x100000000_b) * B(0x8001_b) == B(0x800100000000_b));
	REQUIRE(B(0x100000000_b) * B(0xffff_b) == B(0xffff00000000_b));
	REQUIRE(B(0x100000000_b) * B(0x10000_b) == B(0x1000000000000_b));
	REQUIRE(B(0x100000000_b) * B(0x10001_b) == B(0x1000100000000_b));
	REQUIRE(B(0x100000000_b) * B(0x7fffffff_b) == B(0x7fffffff00000000_b));
	REQUIRE(B(0x100000000_b) * B(0x80000000_b) == B(0x8000000000000000_b));
	REQUIRE(B(0x100000000_b) * B(0x80000001_b) == B(0x8000000100000000_b));
	REQUIRE(B(0x100000000_b) * B(0xffffffff_b) == B(0xffffffff00000000_b));
	REQUIRE(B(0x100000000_b) * B(0x100000000_b) == B(0x10000000000000000_b));
	REQUIRE(B(0x100000000_b) * B(0x100000001_b) == B(0x10000000100000000_b));
	REQUIRE(B(0x100000001_b) * B(-0x100000001_b) == B(-0x10000000200000001_b));
	REQUIRE(B(0x100000001_b) * B(-0x100000000_b) == B(-0x10000000100000000_b));
	REQUIRE(B(0x100000001_b) * B(-0xffffffff_b) == B(-0xffffffffffffffff_b));
	REQUIRE(B(0x100000001_b) * B(-0x80000001_b) == B(-0x8000000180000001_b));
	REQUIRE(B(0x100000001_b) * B(-0x80000000_b) == B(-0x8000000080000000_b));
	REQUIRE(B(0x100000001_b) * B(-0x7fffffff_b) == B(-0x7fffffff7fffffff_b));
	REQUIRE(B(0x100000001_b) * B(-0x10001_b) == B(-0x1000100010001_b));
	REQUIRE(B(0x100000001_b) * B(-0x10000_b) == B(-0x1000000010000_b));
	REQUIRE(B(0x100000001_b) * B(-0xffff_b) == B(-0xffff0000ffff_b));
	REQUIRE(B(0x100000001_b) * B(-0x8001_b) == B(-0x800100008001_b));
	REQUIRE(B(0x100000001_b) * B(-0x8000_b) == B(-0x800000008000_b));
	REQUIRE(B(0x100000001_b) * B(-0x7fff_b) == B(-0x7fff00007fff_b));
	REQUIRE(B(0x100000001_b) * B(0x7fff_b) == B(0x7fff00007fff_b));
	REQUIRE(B(0x100000001_b) * B(0x8000_b) == B(0x800000008000_b));
	REQUIRE(B(0x100000001_b) * B(0x8001_b) == B(0x800100008001_b));
	REQUIRE(B(0x100000001_b) * B(0xffff_b) == B(0xffff0000ffff_b));
	REQUIRE(B(0x100000001_b) * B(0x10000_b) == B(0x1000000010000_b));
	REQUIRE(B(0x100000001_b) * B(0x10001_b) == B(0x1000100010001_b));
	REQUIRE(B(0x100000001_b) * B(0x7fffffff_b) == B(0x7fffffff7fffffff_b));
	REQUIRE(B(0x100000001_b) * B(0x80000000_b) == B(0x8000000080000000_b));
	REQUIRE(B(0x100000001_b) * B(0x80000001_b) == B(0x8000000180000001_b));
	REQUIRE(B(0x100000001_b) * B(0xffffffff_b) == B(0xffffffffffffffff_b));
	REQUIRE(B(0x100000001_b) * B(0x100000000_b) == B(0x10000000100000000_b));
	REQUIRE(B(0x100000001_b) * B(0x100000001_b) == B(0x10000000200000001_b));
}
